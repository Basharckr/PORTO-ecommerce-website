{% extends 'owner/base.html' %}
{% load static %}
{% block title %}Manage categary{% endblock %}
{% block content %}

<!--Category management DataTales  -->
<div class="card shadow mb-4 mt-4 col-md-12">
    <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary text-center">Categories</h6>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        <th class="text-center">Category name</th>
                        <th class="text-center">Action</th>
                    </tr>
                </thead>
                <tbody>
                {% for category in category %}
                    <tr>
                        <td>{{category.category_name}}</td>
                      
                            <td class="text-center"><a class='btn btn-info btn-xs' href="{% url 'edit-category' pk=category.id %}"><span
                                class="glyphicon glyphicon-edit"></span> Edit</a>
                       

                            <a href="{% url 'delete-category' pk=category.id %}"
                                onclick="return confirm('Are you sure you want to delete this?')"
                                class="btn btn-danger btn-xs"><span class="glyphicon glyphicon-remove"></span> Del</a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>

            </table>
        </div>
    </div>
</div>
<script src="{% static 'owner/vendor/jquery/jquery.min.js'%}"></script>

<script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>

<script>

$().ready(function (){
    var pk="{{category.id}}"
    console.log(pk)
    console.log('d')
    $("#editcategory").validate({
        rules:{
            category:{
                required:true, minlength:3
             
            },
        },
        messages: {
            category: {
                required: "Enter category name..",
                minlength: "Category name should be 3 charecter"
            },
        },
        submitHandler: (editcategory, e) => {
            
            e.preventDefault()
            $.ajax({
                url: "edit-category/"+pk+"/",
                data:$("#addcategory").serialize(),
                method: "post",
        
                success: function (response) {
                    if (response == 'true') {
                        window.location.replace('manage-category')
                    }
                    if(response == 'false'){
                        $("#error1").html("This Category already added!!")
                    }
                },

            })
        }
    });
});
</script>

{% endblock %}